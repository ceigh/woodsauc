var woodsauc=function(n){var o={};function c(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,c),t.l=!0,t.exports}return c.m=n,c.c=o,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)c.d(n,o,function(e){return t[e]}.bind(null,o));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c(c.s=1)}([,function(module,exports){var firefox=navigator.userAgent.toLowerCase().includes("firefox");function notificationSound(){var e=new Audio;e.src="/static/sound/light.mp3",e.autoplay=!0}firefox&&!getCookie("bg-url")&&(document.querySelector("body").style.backgroundImage="url('/static/img/bg/tree.jpg')");var defaultSize=16.2,defaultMargin=2.6,highestMargin=35.4,maxSize=defaultSize,maxMargin=defaultMargin,styleForSize=document.createElement("style");function changeSize(e){var t,n,o=e.value.length-10,c=document.getElementsByClassName("name");0<o?(t=+(t=defaultSize+2.1*o).toFixed(2),n=(n=defaultMargin+2.1*o).toFixed(2),n=highestMargin<n?highestMargin:n):1===c.length&&(maxSize=defaultSize,maxMargin=defaultMargin,styleForSize.innerText=".name{width:".concat(defaultSize,"vw}#add-btn{width:").concat(defaultSize+10,"vw}.block-buy span{margin-right:").concat(defaultMargin,"vw}")),t&&maxSize<t&&(maxSize=t,maxMargin=n,styleForSize.innerText=".name{width:".concat(t,"vw}#add-btn{width:").concat(t+10,"vw!important}.block-buy span{margin-right:").concat(n,"vw!important}"))}styleForSize.appendChild(document.createTextNode(".name{width:".concat(defaultSize,"vw}"))),document.head.appendChild(styleForSize),String.prototype.toTitle=function(){return this.replace(/(^|\s)\S/g,function(e){return e.toUpperCase()})},String.prototype.truncate=function(){return this.replace(/\s+$/,"").replace(/^\s+/,"")};var started=!1;try{var socket=io("https://socket.donationalerts.ru:443",{reconnection:!1}),token=getCookie("token");token&&socket.emit("add-user",{token:token,type:"minor"}),socket.on("donation",function(e){if(started){var s=JSON.parse(e);1!==s.alert_type&&"1"!==s.alert_type||function(){var c=s.message;c=c.replace(/\s+/g," ");for(var i=+s.amount,a=document.getElementsByClassName("name"),r=document.getElementsByClassName("cost"),e=document.getElementById("notifications-area"),t=!1,n=0;n<Math.min(a.length,r.length);n++){var l=a[n].value;if(l&&c.toLowerCase().includes(l.toLowerCase()))if("break"===function(){var o=document.createElement("div");return o.className="notification",o.innerHTML='<p></p>\n                        <button class="notification-btn" type="button" title="Подтвердить">\n                            <img src="/static/img/icons/material/done.svg" alt="Иконка подтверждения">\n                        </button>\n                        <button class="notification-btn" type="button" title="Отклонить">\n                            <img src="/static/img/icons/material/clear.svg" alt="Иконка очистки">\n                        </button>',o.children[0].innerText="Добавить ₽".concat(i,' к "').concat(l.toTitle().replace(/\s+$/,""),'"?'),o.children[0].setAttribute("title","Добавить ₽".concat(i,' к "').concat(l.toTitle().replace(/\s+$/,""),'"?')),o.children[1].onclick=function(){ripplet(arguments[0]),r=document.getElementsByClassName("cost"),a=document.getElementsByClassName("name");for(var e=0;e<Math.min(a.length,r.length);e++){var t=a[e].value,n=+r[e].value;t&&c.toLowerCase().includes(t.toLowerCase())&&(r[e].value=i+n,checkOnBuy(r[e]),sortCandidates(),changeTitle(r[e]),o.classList.add("hidden"),setTimeout(function(){o.remove()},300))}},o.children[2].onclick=function(){ripplet(arguments[0]),o.classList.add("hidden"),setTimeout(function(){o.remove()},300)},e.insertBefore(o,e.firstElementChild),notificationSound(),t=!0,"break"}())break}if(!t){var o=document.createElement("div");o.className="notification",o.innerHTML='<p></p>\n                    <button class="notification-btn" type="button" title="Подтвердить">\n                        <img src="/static/img/icons/material/done.svg" alt="Иконка подтверждения">\n                    </button>\n                    <button class="notification-btn" type="button" title="Отклонить">\n                        <img src="/static/img/icons/material/clear.svg" alt="Иконка очистки">\n                    </button>',o.children[0].innerText='Создать "'.concat(c.toTitle().replace(/\s+$/,""),'" с ₽').concat(i,"?"),o.children[0].setAttribute("title",'Создать "'.concat(c.toTitle().replace(/\s+$/,""),'" с ₽').concat(i,"?")),o.children[1].onclick=function(){ripplet(arguments[0]);var e=document.createElement("div");e.className="block",e.innerHTML='<label>\n                           <input class="name" type="text" autocomplete="off"\n                           onkeyup="createLink(this);changeSize(this)" onchange="changeSize(this)"\n                           placeholder="Позиция" spellcheck="false" onclick="ripplet(arguments[0])">\n                           <input onclick="ripplet(arguments[0])" class="cost" type="text" min="0" step="10" \n                             onchange="changeTitle(this);checksum(this);sortCandidates()" \n                             placeholder="₽" value="'.concat(i,'" autocomplete="off">\n                         </label>\n                         <span>\n                         <a href="https://www.kinopoisk.ru" target="_blank" class="kp-link"\n                           onclick="ripplet(arguments[0])" title="Ссылка на кинопоиск">\n                           <img src="/static/img/icons/material/video-library.svg" \n                           alt="Иконка ссылки на кинопоиск"></a>\n                         <button type="button" class="btn" \n                         onclick="ripplet(arguments[0]);removeRow(this)" title="Удалить">\n                           <img src="/static/img/icons/material/delete.svg" alt="Иконка удаления">\n                         </button>\n                         </span>'),e.children[0].children[0].value=c,e.children[0].children[0].setAttribute("title",c),e.children[0].children[1].setAttribute("title","Сумма: ".concat(i," ₽")),changeSize(e.children[0].children[0]),checkOnBuy(e.children[0].children[1]),candidatesArea.insertBefore(e,candidatesArea.lastElementChild),sortCandidates(),setTimeout(function(){e.classList.add("visible")},20);for(var t=0;t<a.length;t++)createLink(a[t]);o.classList.add("hidden"),setTimeout(function(){o.remove()},300)},o.children[2].onclick=function(){ripplet(arguments[0]),o.classList.add("hidden"),setTimeout(function(){o.remove()},300)},e.insertBefore(o,e.firstElementChild),notificationSound()}}()}})}catch(e){console.log("Нет подключения, автодобавление не будет работать.")}function returnWinner(){for(var e=void 0,t=null,n=document.getElementsByClassName("name"),o=document.getElementsByClassName("cost"),c=0;c<Math.min(n.length,o.length);c++){var i=n[c].value,a=+o[c].value;t<a&&(t=a,e=i||e)}return t&&(e=e.toTitle().truncate()),e?'"'.concat(e,'"'):"Никто не "}function startTimer(){started=!0,startBtn.onclick=function(){ripplet(arguments[0])};var e=document.getElementById("timer"),t=e.innerHTML.split(":"),n=t[0],o=t[1],c=t[2];if("00"===c){if("00"===o){if("00"===n){var i=document.querySelector("#modal"),a=document.querySelector("#modal-overlay");started=!1,e.classList.remove("danger"),a.onclick=function(){ripplet(arguments[0]),i.classList.toggle("closed"),a.classList.toggle("closed"),document.title="Аукцион β"};var r=returnWinner();return isBuy?(i.children[0].innerText='"'.concat(buyWinner,'" выкупили, аж за ').concat(buyCost,"₽ Pog!"),document.title=50<buyWinner.length?"".concat(buyWinner.substring(0,50),"... выкупили!"):"".concat(buyWinner," выкупили!")):(i.children[0].innerText="".concat(r," победил!"),document.title=50<r.length?"".concat(r.substring(0,50),"... победил!"):"".concat(r," победил!")),a.classList.toggle("closed"),i.classList.toggle("closed"),notificationSound(),void(startBtn.onclick=function(){ripplet(arguments[0]),startTimer()})}o=59,--n<10&&(n="0".concat(n))}--o<30&&"00"===n?e.className="danger":e.classList.remove("danger"),o<10&&(o="0".concat(o));var l=returnWinner();l="Никто не "===l?"":" - ".concat(l);var s="".concat(n,":").concat(o).concat(l);document.title=50<s.length?"".concat(s.substring(0,50),"..."):s,c=99}else c--;c<10&&(c="0".concat(c)),e.innerHTML="".concat(n,":").concat(o,":").concat(c),setTimeout(startTimer,10)}var startBtn=document.getElementById("start-btn"),resetBtn=document.getElementById("stop-btn"),plusBtn=document.getElementById("plus-btn"),plusTwoBtn=document.getElementById("plus-two-btn"),minusBtn=document.getElementById("minus-btn");function sortCandidates(){for(var e=[],t=document.getElementsByClassName("name"),n=document.getElementsByClassName("cost"),o=0;o<Math.min(t.length,n.length);o++){var c=t[o].value,i=+n[o].value,a=t[o].getAttribute("title"),r=n[o].getAttribute("title"),l=t[o].parentNode.parentNode.children[1].children[0].href;e.push({name:c,cost:i,titleName:a,titleCost:r,link:l})}e=e.sort(function(e,t){return e.cost-t.cost}).reverse();for(var s=0;s<Math.min(t.length,n.length);s++){var u=e[s].cost;n[s].value=0===u?"":u,t[s].value=e[s].name,t[s].setAttribute("title",e[s].titleName),n[s].setAttribute("title",e[s].titleCost),t[s].parentNode.parentNode.children[1].children[0].href=e[s].link}}function clearRow(){var e=document.getElementById("candidates-area"),t=e.children[1].children[0],n=e.children[1].children[1].children[0];t.children[0].value="",t.children[1].value="",t.children[0].setAttribute("title","Фильм, игра, etc"),t.children[1].setAttribute("title","Сумма"),n.href="https://www.kinopoisk.ru",changeSize(t.children[0])}function removeRow(t){setTimeout(function(){try{t.parentNode.parentNode.parentNode.removeChild(t.parentNode.parentNode)}catch(e){}var e=document.getElementsByClassName("name");1!==e.length||e[0].value||(maxSize=defaultSize,styleForSize.innerText=".name{width:".concat(defaultSize,"vw}#add-btn{width:").concat(defaultSize+10,"vw}"))},200)}function trim(e){return e.replace(/^\s+/,"").replace(/\s{2,}$/,"").replace(/\s+/g," ")}function createLink(e){e.value=trim(e.value);var t=e.value;t?(e.parentNode.parentNode.children[1].children[0].href=encodeURI("https://www.kinopoisk.ru/s/type/all/find/".concat(t,"/")),e.setAttribute("title",t.toTitle())):(e.parentNode.parentNode.children[1].children[0].href="https://www.kinopoisk.ru",e.setAttribute("title","Фильм, игра, etc"))}startBtn.onclick=function(){ripplet(arguments[0]),startTimer()},resetBtn.onclick=function(){ripplet(arguments[0]),timer.innerHTML="00:00:00";for(var e=document.getElementById("notifications-area");0<e.children.length;)e.removeChild(e.firstChild)},plusBtn.onclick=function(){ripplet(arguments[0]);var e=timer.innerHTML.split(":"),t=e[0],n=e[1],o=e[2];++t<10&&(t="0".concat(t)),timer.innerHTML="".concat(t,":").concat(n,":").concat(o)},plusTwoBtn.onclick=function(){ripplet(arguments[0]);var e=timer.innerHTML.split(":"),t=e[0],n=e[1],o=e[2];t++,++t<10&&(t="0".concat(t)),timer.innerHTML="".concat(t,":").concat(n,":").concat(o)},minusBtn.onclick=function(){ripplet(arguments[0]);var e=timer.innerHTML.split(":"),t=e[0],n=e[1],o=e[2];--t<0?t="00":t<10&&(t="0".concat(t)),timer.innerHTML="".concat(t,":").concat(n,":").concat(o)};var addBtn=document.getElementById("add-btn"),candidatesArea=document.getElementById("candidates-area");function getCookie(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function setCookie(e,t,n){var o=(n=n||{}).expires;if("number"==typeof o&&o){var c=new Date;c.setTime(c.getTime()+1e3*o),o=n.expires=c}o&&o.toUTCString&&(n.expires=o.toUTCString()),t=encodeURIComponent(t);var i="".concat(e,"=").concat(t);for(var a in n){i+="; "+a;var r=n[a];!0!==r&&(i+="="+r)}document.cookie=i}function changeBG(e){var t=document.querySelector("body");t.style.backgroundImage=e&&""!==e?"url(".concat(e,")"):firefox?"url('/static/img/bg/tree.jpg')":"url('/static/img/bg/tree.webp')"}function sheet(e){var t=document.createElement("style");return t.appendChild(document.createTextNode(e)),document.head.appendChild(t),t}function textSelect(e){e.focus(),e.select()}addBtn.onclick=function(){var e=document.createElement("div");e.className="block",e.innerHTML='<label>\n           <input class="name" type="text" onkeyup="createLink(this);changeSize(this)"  onchange="changeSize(this)"\n             onclick="ripplet(arguments[0])" title="Фильм, игра, etc" autocomplete="off" placeholder="Позиция" spellcheck="false">\n           <input class="cost" type="text" min="0" step="10" placeholder="₽" title="Сумма"\n             onclick="ripplet(arguments[0])" onchange="changeTitle(this);checksum(this);sortCandidates();checkOnBuy(this)" autocomplete="off">\n         </label>\n         <span>\n         <a href="https://www.kinopoisk.ru" target="_blank" class="kp-link" \n           onclick="ripplet(arguments[0])" title="Ссылка на кинопоиск">\n           <img src="/static/img/icons/material/video-library.svg" alt="Иконка ссылки на кинопоиск"></a>\n         <button type="button" class="btn" \n           onclick="ripplet(arguments[0]);removeRow(this)" title="Удалить">\n           <img src="/static/img/icons/material/delete.svg" alt="Иконка удаления">\n         </button>\n        </span>',candidatesArea.insertBefore(e,candidatesArea.lastElementChild),ripplet(arguments[0]),setTimeout(function(){e.classList.add("visible")},10),e.children[0].children[0].focus(),sortCandidates()};var showSettingsBtn=document.getElementById("settings-icon"),settingsWindow=document.getElementById("settings"),saveBGURLBtn=document.getElementById("save-bg-url-btn"),clearBGURLBtn=document.getElementById("clear-bg-url-btn"),bgURLInput=document.getElementById("bg-url"),colorExctractor=document.getElementById("color-extractor"),year=31622400,bgURL=getCookie("bg-url"),styleElement;function hexToRgb(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}bgURLInput.onclick=function(){ripplet(arguments[0]),textSelect(this)},showSettingsBtn.onclick=function(){ripplet(arguments[0]),settingsWindow.classList.toggle("closed")};var colorCookie=getCookie("accent"),color;if(ripplet.defaultOptions.clearingDuration=".3s",ripplet.defaultOptions.spreadingDuration=".3s",colorCookie){var rgb=hexToRgb(colorCookie);color="rgba(".concat(rgb.r,", ").concat(rgb.g,", ").concat(rgb.b,", .6)")}else color="rgba(243, 151, 39, .6)";if(ripplet.defaultOptions.color=color,colorCookie&&""!==colorCookie){var accentShadow=hexToRgb(colorCookie);accentShadow="rgba(".concat(accentShadow.r,", ").concat(accentShadow.g,", ").concat(accentShadow.b,", 0.7)"),styleElement=sheet(".name,.cost,#bg-url,.danger,#da-url,.cost-buy{color:".concat(colorCookie,"!important}\ninput:focus{--accent:").concat(colorCookie,"!important;--shadow:").concat(accentShadow,"!important}"))}else styleElement=sheet(".name,.cost,#bg-url,.danger,#da-url,.cost-buy{color:#f39727!important}\ninput:focus{--accent:#f39727!important;--shadow:rgba(243, 151, 39, 0.7)!important}");saveBGURLBtn.onclick=function(){changeBG(bgURLInput.value),ripplet(arguments[0]),colorExctractor.setAttribute("src","https://cors-anywhere.herokuapp.com/".concat(bgURLInput.value)),colorExctractor.addEventListener("load",function(){var e=new Vibrant(this).swatches().Vibrant.getHex(),t=hexToRgb(e);ripplet.defaultOptions.color="rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", .6)"),t="rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", 0.7)"),styleElement.innerText=".name,.cost,#bg-url,.danger,#da-url,.cost-buy{color:".concat(e,"!important}\ninput:focus{--accent:").concat(e,"!important;--shadow:").concat(t,"!important}"),setCookie("bg-url",bgURLInput.value,{expires:year}),setCookie("accent",e,{expires:year})})},clearBGURLBtn.onclick=function(){changeBG(""),ripplet(arguments[0]),bgURLInput.value="",ripplet.defaultOptions.color="rgba(243, 151, 39, .6)",styleElement.innerText=".name,.cost,#bg-url,.danger,#da-url,.cost-buy{color:#f39727!important}\ninput:focus{--accent:#f39727!important;--shadow:rgba(243, 151, 39, 0.7)!important});",setCookie("bg-url","",{expires:year}),setCookie("accent","",{expires:year})},changeBG(bgURL),bgURLInput.value=bgURL||"";var daURL=document.getElementById("da-url"),saveDAURLBtn=document.getElementById("save-da-url-btn"),clearDAURLBtn=document.getElementById("clear-da-url-btn"),tokenCookie=getCookie("token");function changeTitle(e){var t=e.value?": ".concat(e.value," ₽"):"";e.setAttribute("title","Сумма".concat(t))}daURL.onclick=function(){ripplet(arguments[0]),textSelect(this)},daURL.value=tokenCookie||"",saveDAURLBtn.onclick=function(){ripplet(arguments[0]),setCookie("token",daURL.value,{expires:year});var e=document.getElementById("notifications-area"),t=document.createElement("div");t.className="notification",t.innerHTML='<p title="Токен сохранен">Токен сохранен</p>',e.insertBefore(t,e.firstElementChild),notificationSound(),setTimeout(function(){t.classList.add("hidden"),setTimeout(function(){t.remove(),location.reload()},300)},800)},clearDAURLBtn.onclick=function(){ripplet(arguments[0]),setCookie("token",daURL.value="",{expires:year});var e=document.getElementById("notifications-area"),t=document.createElement("div");t.className="notification",t.innerHTML='<p title="Токен удален">Токен удален</p>',e.insertBefore(t,e.firstElementChild),notificationSound(),setTimeout(function(){t.classList.add("hidden"),setTimeout(function(){t.remove(),location.reload()},300)},800)},document.onkeydown=function(e){var t=document.getElementById("modal-overlay");t.classList.contains("closed")||"Escape"!==e.key||t.click()};var resetButton=document.getElementById("reset-icon");resetButton.onclick=function(){ripplet(arguments[0]);for(var e=document.getElementById("candidates-area");3<e.children.length;)e.removeChild(e.children[e.children.length-2]);clearRow()};for(var urlsBtns=document.getElementsByClassName("special-url"),i=0;i<urlsBtns.length;i++)urlsBtns[i].onclick=function(){ripplet(arguments[0])};function checksum(costElement){var calculated=costElement.value.replace(/[^\d+*/,.-]/g,"");calculated=calculated.replace(/,/,".");try{calculated=eval(calculated),isNaN(calculated)||!isFinite(calculated)?(costElement.value="",costElement.setAttribute("title","Сумма")):(calculated=0<calculated?+calculated.toFixed(2):"",costElement.value=calculated,costElement.setAttribute("title","Сумма: ".concat(calculated," ₽")))}catch(e){costElement.value="",costElement.setAttribute("title","Сумма")}}var costBuy=document.getElementsByClassName("cost-buy")[0],costBuyCookie=getCookie("buyCost"),costBuyClearBtn=document.querySelector(".block-buy .btn"),isBuy=!1,buyWinner,buyCost;function checkOnBuy(e){var t=+costBuy.value,n=+e.value,o=e.previousElementSibling.value.toTitle().truncate();if(t&&o&&t<=n)if(started)buyWinner=o,buyCost=n,isBuy=!0,timer.innerHTML="00:00:00";else{var c=document.querySelector("#modal"),i=document.querySelector("#modal-overlay");i.onclick=function(){ripplet(arguments[0]),c.classList.toggle("closed"),i.classList.toggle("closed"),document.title="Аукцион β"},c.children[0].innerText='"'.concat(o,'" выкупили, аж за ').concat(n,"₽ Pog!"),document.title=50<o.length?"".concat(o.substring(0,50),"... выкупили!"):"".concat(o," выкупили!"),c.classList.toggle("closed"),i.classList.toggle("closed"),notificationSound()}}costBuy.value=costBuyCookie||"",changeTitle(costBuy),costBuy.onchange=function(){changeTitle(this),checksum(this),setCookie("buyCost",this.value,{expires:year})},costBuy.onclick=function(){ripplet(arguments[0])},costBuyClearBtn.onclick=function(){ripplet(arguments[0]),setCookie("buyCost",costBuy.value="",{expires:-1})}}]);